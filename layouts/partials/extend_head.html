{{ partial "fonts.html" . }}
{{/* Apply palette preference ASAP to avoid noticeable flash. */}}
<script>
(() => {
  const palettes = ["palette-burgundy", "palette-teal", "palette-amber"];
  const html = document.documentElement;
  const configFallback = {{ site.Params.bodyClass | default "palette-teal" | jsonify }};
  const fallback = palettes.includes(configFallback) ? configFallback : "palette-teal";
  let stored = "";
  try {
    stored = localStorage.getItem("pref-palette") || "";
  } catch (e) {
    /* ignore */
  }
  const next = palettes.includes(stored) ? stored : fallback;
  if (!next) return;
  for (const p of palettes) html.classList.remove(p);
  html.classList.add(next);
})();
</script>
